"use strict";(self.webpackChunkvue3_antd_admin=self.webpackChunkvue3_antd_admin||[]).push([[4064],{67186:function(e,t,i){i.r(t),i.d(t,{default:function(){return C}});var n=i(66252),o=i(49963),l=i(3577),a=["src"],r=["src"],u={key:0,class:"toolbar"};var c=i(95082),d=i(82482),m=(i(49282),i(47297)),s=(i(68309),i(2262)),g=i(78582),v=i(73974),f=i(9173),h=i(83925),p=i(60191),w=i(27959);i(74916),i(23123),i(41539),i(78783),i(33948),i(60285),i(41637);function y(e){var t=e.lastIndexOf("/")+1,i=e.substring(t);return i=decodeURI(i.split("?")[0])}var k=(0,n.aZ)({name:"PreviewModal",components:(0,d.Z)({ZoomInOutlined:g.Z,ZoomOutOutlined:v.Z,RedoOutlined:f.Z,DownloadOutlined:h.Z,CloseCircleOutlined:p.Z,OneToOneOutlined:w.Z},m.Z.name,m.Z),props:{visible:{type:Boolean,default:!1},type:{type:String,default:"image"},url:{type:String,default:""}},emits:["update:visible"],setup:function(e,t){var i,n=t.emit,o=(0,s.iH)(),l=(0,s.qj)({timer:null,loading:!1,rotateDeg:0,imgScale:1,scaleCV:.07,initWidth:0,initHeight:0,contentStyle:{width:"60vw",height:"60vh"},imgStyle:{width:"",height:"",transform:"rotate(0)"}}),a=(0,s.Fl)({get:function(){return e.visible},set:function(e){return n("update:visible",e)}}),r=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scale";l.imgStyle.width=l.initWidth*l.imgScale+"px",l.imgStyle.height=l.initHeight*l.imgScale+"px","init"===t?(l.imgStyle.maxWidth="",l.imgStyle.maxHeight=""):(l.imgStyle.maxWidth="none!important",l.imgStyle.maxHeight="none!important"),clearTimeout(i),i=setTimeout((function(){var e;return null===(e=o.value)||void 0===e?void 0:e.classList.remove("active")}),1400),null===(e=o.value)||void 0===e||e.classList.add("active"),l.contentStyle={}};return(0,c.Z)((0,c.Z)({},(0,s.BK)(l)),{},{imgScaleMask:o,isVisible:a,rotateImg:function(){l.rotateDeg-=90,l.imgStyle.transform="rotate(".concat(l.rotateDeg,"deg)")},saveImg:function(e){!function(e){var t=e.url,i=e.target,n=void 0===i?"_blank":i,o=e.fileName,l=new URL(t).host==location.host;new Promise((function(e,i){if(l){var a=document.createElement("a");if(a.href=t,a.target=n,void 0!==a.download&&(a.download=o||y(t)),document.createEvent){var r=document.createEvent("MouseEvents");return r.initEvent("click",!0,!0),a.dispatchEvent(r),e(!0)}return-1===t.indexOf("?")&&(t+="?download"),window.open(t,n),e(!0)}var u=document.createElement("canvas"),c=document.createElement("img");c.setAttribute("crossOrigin","Anonymous"),c.src=t,c.onload=function(i){u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0,c.width,c.height),u.toBlob((function(i){var n=document.createElement("a");n.href=window.URL.createObjectURL(i),n.download=y(t),n.click(),URL.revokeObjectURL(n.href),e(!0)}),"image/jpeg")},c.onerror=function(e){return i(e)}}))}({url:e})},zoomInImg:function(){l.imgScale+=l.scaleCV,r()},zoomOutImg:function(){l.imgScale-=l.scaleCV,r()},handZoom:r,imgLoaded:function(e){var t;if(null!==(t=e.currentTarget)&&void 0!==t&&t.complete){var i=getComputedStyle(e.currentTarget),n=i.width,o=i.height;l.imgStyle.width=n,l.imgStyle.height=o,l.initWidth=parseFloat(n),l.initHeight=parseFloat(o)}},resetImg:function(){l.imgScale=1,r()}})}});const S=(0,i(83744).Z)(k,[["render",function(e,t,i,c,d,m){var s=(0,n.up)("close-circle-outlined"),g=(0,n.up)("a-spin"),v=(0,n.up)("zoom-in-outlined"),f=(0,n.up)("zoom-out-outlined"),h=(0,n.up)("one-to-one-outlined"),p=(0,n.up)("redo-outlined"),w=(0,n.up)("download-outlined");return(0,n.wg)(),(0,n.j4)(n.lR,{to:"body"},[e.isVisible?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"preview-modal",onClick:t[5]||(t[5]=(0,o.iM)((function(t){return e.isVisible=!1}),["self"]))},[(0,n.Wm)(s,{class:"close-icon",onClick:t[0]||(t[0]=function(t){return e.isVisible=!1})}),(0,n._)("div",{class:"preview-content",style:(0,l.j5)(e.contentStyle)},[(0,n.Wm)(g,{spinning:e.loading},{default:(0,n.w5)((function(){return["image"===e.type?((0,n.wg)(),(0,n.iD)("img",{key:0,ref:"img",style:(0,l.j5)(e.imgStyle),src:e.url,alt:"",onLoad:t[1]||(t[1]=(0,o.iM)((function(){return e.imgLoaded&&e.imgLoaded.apply(e,arguments)}),["stop"]))},null,44,a)):(0,n.kq)("",!0),"video"===e.type?((0,n.wg)(),(0,n.iD)("video",{key:1,ref:"video",src:e.url,controls:"",autoplay:"",onCanplay:t[2]||(t[2]=function(t){return e.loading=!1}),onLoadstart:t[3]||(t[3]=function(t){return e.loading=!0})},null,40,r)):(0,n.kq)("",!0),(0,n._)("div",{ref:"imgScaleMask",class:"img-scale-mask"},(0,l.zw)(~~(100*e.imgScale)+"%"),513)]})),_:1},8,["spinning"])],4),"image"===e.type?((0,n.wg)(),(0,n.iD)("div",u,[(0,n.Wm)(v,{title:"放大",onClick:e.zoomInImg},null,8,["onClick"]),(0,n.Wm)(f,{title:"缩放",onClick:e.zoomOutImg},null,8,["onClick"]),(0,n.Wm)(h,{title:"原始比例",onClick:e.resetImg},null,8,["onClick"]),(0,n.Wm)(p,{title:"旋转",onClick:e.rotateImg},null,8,["onClick"]),(0,n.Wm)(w,{title:"下载",onClick:t[4]||(t[4]=function(t){return e.saveImg(e.url)})})])):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])}]]);var C=S}}]);