"use strict";(self.webpackChunkvue3_antd_admin=self.webpackChunkvue3_antd_admin||[]).push([[6088,1674,3772],{70853:function(e,t,a){a.r(t),a.d(t,{TableAction:function(){return n.default},QueryForm:function(){return o.default},ToolBar:function(){return l.default}});var n=a(64471),o=a(90746),l=a(50631)},24718:function(e,t,a){a.r(t),a.d(t,{usePagination:function(){return o}});var n=a(2262);function o(e){const t=(0,n.iH)(!1);return Object.is(e,!1)||(t.value={current:1,pageSize:10,total:0,pageSizeOptions:["10","20","30","40","50"],showQuickJumper:!0,showSizeChanger:!0,showTotal:e=>`共 ${e} 条`,...e}),{paginationRef:t}}},90746:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var n=a(66252),o=a(3577);const l={class:"table-search"},r={class:"search-submitButtons",style:{float:"right",overflow:"hidden"}},s=(0,n.Uk)(" 重置 "),i=(0,n.Uk)(" 查询 ");var u=a(2262),c=a(87849),d=a(53641),m=a(49963);const p=(0,n.aZ)({name:"QueryForm",components:{DownOutlined:c.Z,SchemaForm:d.default},props:{defaultShowItems:{type:Number,default:3},formProps:{type:Object,default:()=>({})},columns:{type:Object,required:!0}},emits:["query","reset"],setup(e,{slots:t,emit:a}){const n=(0,u.qj)({advanced:!1,labelMap:{}}),o=(0,u.iH)(),l=e=>`${e.key||e.dataIndex||""}`.split(".").pop()||"",r=(0,u.Fl)((()=>(n.advanced?.5:0)+"turn")),s=(0,u.Fl)((()=>({schemas:n.advanced?i.value:i.value.slice(0,e.defaultShowItems),labelWidth:80,...e.formProps}))),i=(0,u.Fl)((()=>e.columns.filter((e=>!e.hideInSearch&&!!l(e))).map((e=>({field:e.formItemProps?.field??e.searchField??l(e),component:"Input",label:e.title,colProps:{span:8},...e.formItemProps})))));return{...(0,u.BK)(n),dynamicFormRef:o,turn:r,reset:()=>{o.value?.resetFields()},query:async()=>{const e=await(o.value?.validate());a("query",e)},calcSubBtnOffset:a=>{const o=(n.advanced?Object.keys(t).length:e.defaultShowItems)*a,l=o%24;return o<24||0===l?0:24-l},formSchema:s,formItemSchemas:i,toggleAdvanced:()=>{n.advanced=!n.advanced}}}}),f=()=>{(0,m.sj)((e=>({69857300:e.turn})))},g=p.setup;p.setup=g?(e,t)=>(f(),g(e,t)):f;var y=p;var h=(0,a(83744).Z)(y,[["render",function(e,t,a,u,c,d){const m=(0,n.up)("a-button"),p=(0,n.up)("DownOutlined"),f=(0,n.up)("schema-form");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(f,{ref:"dynamicFormRef","form-schema":e.formSchema},{"operate-button":(0,n.w5)((()=>[(0,n._)("span",r,[(0,n._)("span",null,[(0,n.Wm)(m,{type:"default",style:{"margin-right":"10px"},onClick:e.reset},{default:(0,n.w5)((()=>[s])),_:1},8,["onClick"]),(0,n.Wm)(m,{type:"primary",onClick:e.query},{default:(0,n.w5)((()=>[i])),_:1},8,["onClick"])]),e.formItemSchemas.length>0&&e.formItemSchemas.length>e.defaultShowItems?((0,n.wg)(),(0,n.iD)("a",{key:0,style:{"margin-left":"8px"},onClick:t[0]||(t[0]=(...t)=>e.toggleAdvanced&&e.toggleAdvanced(...t))},[(0,n.Uk)((0,o.zw)(e.advanced?"收起":"展开")+" ",1),(0,n.Wm)(p,{class:"collapse-icon"})])):(0,n.kq)("",!0)])])),_:1},8,["form-schema"])])}],["__scopeId","data-v-1f73bd71"]])},64471:function(e,t,a){a.r(t),a.d(t,{default:function(){return s}});a(15921);var n=a(87204),o=a(66252),l=a(2262),r=a(3577);var s=(0,o.aZ)({props:{actions:{type:Array,default:()=>[]}},setup:e=>(t,a)=>{const s=(0,o.up)("a-button");return(0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.actions,((e,t)=>((0,o.wg)(),(0,o.j4)((0,o.LL)(e.popConfirm?(0,l.SU)(n.Z):"span"),(0,o.dG)({key:`${t}-${e.label}`,title:e.title,"ok-text":"确认","cancel-text":"取消"},e.popConfirm),{default:(0,o.w5)((()=>[(0,o.Wm)(s,(0,o.dG)({type:"link"},e),{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.label),1)])),_:2},1040)])),_:2},1040,["title"])))),128)}})},86088:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});a(46314);var n=a(66252),o=a(3577);const l={class:"bg-white"};a(6788);var r=a(97139),s=(a(6571),a(13252)),i=a(57557),u=a.n(i),c=a(2262),d=a(97307),m=a(24718),p=a(70094),f=a(70029),g=a(70853),y=(0,n.aZ)({name:"DynamicTable",components:{Table:s.ZP,Space:r.Z,TableAction:g.TableAction,QueryForm:g.QueryForm,ToolBar:g.ToolBar},inheritAttrs:!1,props:{...(0,d.iO)(),formProps:{type:Object,default:()=>({})},columns:{type:Object,required:!0},dataRequest:{type:Function},showToolBar:{type:Boolean,default:!0},headerTitle:String,search:{type:Boolean,default:!0}},emits:["change","update:pageOption"],setup(e,{emit:t,slots:a}){(0,f.createTableContext)((0,n.FN)());const o=(0,c.iH)(),l=(0,c.iH)(),r=(0,c.Fl)((()=>({...e,...(0,c.SU)(l)}))),{paginationRef:s}=(0,m.usePagination)(e.pagination),i=(0,c.qj)({expandItemRefs:{},tableData:[],loading:!1});(0,n.YP)((()=>e.dataSource),(e=>{e&&(i.tableData=e)}),{deep:!0,immediate:!0});const d=async(t={})=>{if(Object.is(e.dataSource,void 0)&&Object.prototype.toString.call(e.dataRequest).includes("Function")){const a=(0,c.SU)(s),n={...t};(0,p.Kn)(a)&&Object.assign(n,{page:a.current,limit:a.pageSize}),i.loading=!0;const o=await(e?.dataRequest?.(n).finally((()=>i.loading=!1)));o?.pagination&&Object.assign((0,c.SU)(s),{current:~~o?.pagination.page,pageSize:~~o?.pagination.size,total:~~o?.pagination.total}),i.tableData=o?.list||[]}};d();const g=(0,c.Fl)((()=>{const e=(0,c.SU)(r);let t={...e,rowKey:e.rowKey??"id",loading:i.loading,tableLayout:"fixed",pagination:(0,c.SU)(s)};return a.expandedRowRender&&(t=u()(t,"scroll")),t=u()(t,["class","onChange"]),t}));return{...(0,c.BK)(i),tableRef:o,defaultSlots:["emptyText","expandIcon","title","footer","summary","expandedRowRender","customFilterIcon","customFilterDropdown"],getProps:r,getBindValues:g,queryTable:e=>{d(e)},setProps:e=>{l.value={...(0,c.SU)(l),...e}},getColumnKey:e=>e.key||e.dataIndex,handleTableChange:(...e)=>{const[a]=e;Object.keys(a).length&&Object.assign((0,c.SU)(s),a),d(),t("change",...e)},refreshTable:(e=!1)=>{const t=(0,c.SU)(s);Object.is(e,!0)&&(0,p.Kn)(t)&&(t.current=1),d()}}}});var h=(0,a(83744).Z)(y,[["render",function(e,t,a,r,s,i){const u=(0,n.up)("QueryForm"),c=(0,n.up)("Space"),d=(0,n.up)("ToolBar"),m=(0,n.up)("TableAction"),p=(0,n.up)("Table");return(0,n.wg)(),(0,n.iD)("div",null,[e.search?((0,n.wg)(),(0,n.j4)(u,{key:0,columns:e.columns,formProps:e.formProps,onQuery:e.queryTable},null,8,["columns","formProps","onQuery"])):(0,n.kq)("",!0),(0,n._)("div",l,[e.showToolBar?((0,n.wg)(),(0,n.j4)(d,{key:0,title:e.headerTitle},(0,n.Nv)({_:2},[e.$slots.headerTitle?{name:"headerTitle",fn:(0,n.w5)((()=>[(0,n.WI)(e.$slots,"headerTitle",{},void 0,!0)]))}:void 0,e.$slots.toolbar?{name:"toolbar",fn:(0,n.w5)((()=>[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n.WI)(e.$slots,"toolbar",{},void 0,!0)])),_:3})]))}:void 0]),1032,["title"])):(0,n.kq)("",!0),(0,n.Wm)(p,(0,n.dG)({ref:"tableRef"},e.getBindValues,{dataSource:e.tableData,onChange:e.handleTableChange}),(0,n.Nv)({_:2},[(0,n.Ko)(e.defaultSlots.filter((t=>Object.hasOwn(e.$slots,t))),(t=>({name:t,fn:(0,n.w5)((a=>[(0,n.WI)(e.$slots,t,(0,o.vs)((0,n.F4)(a)),void 0,!0)]))}))),(0,n.Ko)(["bodyCell","headerCell"],(t=>({name:t,fn:(0,n.w5)((a=>[(0,n.WI)(e.$slots,t,(0,o.vs)((0,n.F4)(a)),void 0,!0),"bodyCell"===t&&"$action"===e.getColumnKey(a.column)?((0,n.wg)(),(0,n.j4)(m,{key:0,actions:a.column.actions(a)},null,8,["actions"])):(0,n.kq)("",!0),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.columns.filter((e=>e[t])),(o=>((0,n.wg)(),(0,n.iD)(n.HY,{key:e.getColumnKey(o)},[e.getColumnKey(a.column)===e.getColumnKey(o)?((0,n.wg)(),(0,n.j4)((0,n.LL)(o?.[t]?.(a)),{key:0})):(0,n.kq)("",!0)],64)))),128))]))})))]),1040,["dataSource","onChange"])])])}],["__scopeId","data-v-20895536"]])}}]);